import{c as P,b as C,u as S,r as p,j as e,h as w,B as v,m as F,I as U,s as E,F as A}from"./index-90132984.js";import{L}from"./label-10800e5f.js";import{U as b}from"./user-404ce197.js";import{M as q}from"./mail-a6fc1731.js";import{E as D,a as T}from"./eye-dd65b377.js";const I=P("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),o=({id:s,label:c,type:r="text",placeholder:y,value:a,onChange:f,required:i=!1,icon:n,children:t})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:s,className:"text-foreground dark:text-slate-200 flex items-center",children:[n," ",c]}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{id:s,type:r,placeholder:y,value:a,onChange:f,required:i,className:"bg-background/60 dark:bg-slate-700/40 border-slate-300/50 dark:border-slate-600/50 focus:border-primary dark:focus:border-secondary focus:ring-primary dark:focus:ring-secondary pr-10"}),t]})]});o.displayName="FormField";const x=({show:s,onClick:c,ariaLabel:r})=>e.jsx(v,{type:"button",variant:"ghost",size:"icon",className:"absolute inset-y-0 right-0 h-full px-3 text-muted-foreground hover:bg-transparent focus:outline-none",onClick:c,"aria-label":r,children:s?e.jsx(D,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"})});x.displayName="PasswordToggle";const _=({onSuccess:s,isModal:c=!1})=>{const{toast:r}=C(),y=S(),[a,f]=p.useState({firstName:"",surname:"",email:"",password:"",confirmPassword:""}),[i,n]=p.useState(!1),[t,N]=p.useState(!1),[d,j]=p.useState(!1),l=m=>{f({...a,[m.target.id]:m.target.value})},k=async m=>{if(m.preventDefault(),a.password!==a.confirmPassword){r({title:"Passwords Don't Match",description:"Please ensure your passwords match.",variant:"destructive"});return}n(!0);try{const h=`${a.firstName} ${a.surname}`.trim(),{data:g,error:u}=await E.auth.signUp({email:a.email,password:a.password,options:{emailRedirectTo:`${window.location.origin}/auth/callback`,data:{full_name:h,first_name:a.firstName,surname:a.surname}}});if(u)if(u.message.toLowerCase().includes("failed to fetch")||u.message.toLowerCase().includes("network error"))r({title:"Network Error",description:"Could not create account. Please check your internet connection and try again.",variant:"destructive",icon:e.jsx(A,{className:"h-5 w-5 text-destructive-foreground"})});else throw u;else if(g.user){if(Array.isArray(g.user.identities)&&g.user.identities.length===0){r({title:"Email Already Registered",description:"Try signing in or use 'Forgot password' to verify your email.",variant:"destructive"}),n(!1);return}r({title:"Account Created!",description:"Please check your email to confirm your account.",variant:"default",className:"bg-green-500 dark:bg-green-600 text-white"}),s?s():y("/confirm-email")}}catch(h){r({title:"Sign Up Failed",description:h.message||"Could not create your account. Please try again.",variant:"destructive"})}finally{n(!1)}};return e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(o,{id:"firstName",label:"First Name",placeholder:"John",value:a.firstName,onChange:l,required:!0,icon:e.jsx(b,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"})}),e.jsx(o,{id:"surname",label:"Surname",placeholder:"Doe",value:a.surname,onChange:l,required:!0,icon:e.jsx(b,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"})})]}),e.jsx(o,{id:"email",label:"Email Address",type:"email",placeholder:"you@example.com",value:a.email,onChange:l,required:!0,icon:e.jsx(q,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"})}),e.jsx(o,{id:"password",label:"Password",type:t?"text":"password",placeholder:"••••••••",value:a.password,onChange:l,required:!0,icon:e.jsx(w,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"}),children:e.jsx(x,{show:t,onClick:()=>N(!t),ariaLabel:t?"Hide password":"Show password"})}),e.jsx(o,{id:"confirmPassword",label:"Confirm Password",type:d?"text":"password",placeholder:"••••••••",value:a.confirmPassword,onChange:l,required:!0,icon:e.jsx(w,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"}),children:e.jsx(x,{show:d,onClick:()=>j(!d),ariaLabel:d?"Hide confirm password":"Show confirm password"})}),e.jsxs(v,{type:"submit",className:"w-full text-lg py-3 bg-gradient-to-r from-primary to-purple-600 hover:opacity-90 text-white dark:from-secondary dark:to-orange-400 transition-all duration-300 ease-in-out transform hover:scale-105",disabled:i,children:[i?e.jsx(F.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"}):e.jsx(I,{className:"w-5 h-5 mr-2"}),i?"Creating Account...":"Create Account"]})]})};export{_ as S,I as U};
