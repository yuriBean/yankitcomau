import{b as C,u as F,a as P,r as h,j as e,h as E,L as D,B as k,m as T,I as q,s as A,F as B}from"./index-90132984.js";import{L as z}from"./label-10800e5f.js";import{M as H}from"./mail-a6fc1731.js";import{L as M}from"./log-in-88f4232d.js";import{E as O,a as R}from"./eye-dd65b377.js";const x=({id:a,label:r,type:t="text",placeholder:u,value:o,onChange:d,required:i=!1,icon:s,children:f})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(z,{htmlFor:a,className:"text-foreground dark:text-slate-200 flex items-center",children:[s," ",r]}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{id:a,type:t,placeholder:u,value:o,onChange:d,required:i,className:"bg-background/60 dark:bg-slate-700/40 border-slate-300/50 dark:border-slate-600/50 focus:border-primary dark:focus:border-secondary focus:ring-primary dark:focus:ring-secondary pr-10"}),f]})]});x.displayName="FormField";const N=({show:a,onClick:r,ariaLabel:t})=>e.jsx(k,{type:"button",variant:"ghost",size:"icon",className:"absolute inset-y-0 right-0 h-full px-3 text-muted-foreground hover:bg-transparent focus:outline-none",onClick:r,"aria-label":t,children:a?e.jsx(O,{className:"w-5 h-5"}):e.jsx(R,{className:"w-5 h-5"})});N.displayName="PasswordToggle";const U=({onSuccess:a,isModal:r=!1,searchCriteria:t,formData:u})=>{const{toast:o}=C(),d=F(),i=P(),[s,f]=h.useState({email:"",password:""}),[p,y]=h.useState(!1),[c,S]=h.useState(!1),w=m=>{f({...s,[m.target.id]:m.target.value})},I=async m=>{var b,v,j;m.preventDefault(),y(!0);try{const{data:g,error:n}=await A.auth.signInWithPassword({email:s.email,password:s.password});if(n)if(n.message==="Email not confirmed")o({title:"Email Not Confirmed",description:"Please check your email and click the confirmation link before signing in.",variant:"default",className:"bg-yellow-500 dark:bg-yellow-600 text-white border-yellow-500 dark:border-yellow-600"}),r||d("/confirm-email");else if(n.message.toLowerCase().includes("failed to fetch")||n.message.toLowerCase().includes("network error"))o({title:"Network Error",description:"Could not sign in. Please check your internet connection and try again.",variant:"destructive",icon:e.jsx(B,{className:"h-5 w-5 text-destructive-foreground"})});else throw n;else if(g.user)if(a)a();else{let l=((b=i.state)==null?void 0:b.from)||"/dashboard";l==="/offer-space"&&(l="/yank-a-bag"),l==="/find-space"&&(l="/send-a-bag");const L={searchCriteria:t||((v=i.state)==null?void 0:v.searchCriteria),formData:u||((j=i.state)==null?void 0:j.formData)};d(l,{replace:!0,state:L})}}catch(g){o({title:"Sign In Failed",description:g.message||"Invalid login credentials. Please try again.",variant:"destructive"})}finally{y(!1)}};return e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsx(x,{id:"email",label:"Email Address",type:"email",placeholder:"you@example.com",value:s.email,onChange:w,required:!0,icon:e.jsx(H,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"})}),e.jsx(x,{id:"password",label:"Password",type:c?"text":"password",placeholder:"••••••••",value:s.password,onChange:w,required:!0,icon:e.jsx(E,{className:"w-4 h-4 mr-2 opacity-70 text-primary dark:text-secondary"}),children:e.jsx(N,{show:c,onClick:()=>S(!c),ariaLabel:c?"Hide password":"Show password"})}),!r&&e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"text-sm",children:e.jsx(D,{to:"/forgot-password",className:"font-medium text-primary hover:underline dark:text-secondary",children:"Forgot your password?"})})}),e.jsxs(k,{type:"submit",className:"w-full text-lg py-3 bg-gradient-to-r from-primary to-purple-600 hover:opacity-90 text-white dark:from-secondary dark:to-orange-400 transition-all duration-300 ease-in-out transform hover:scale-105",disabled:p,children:[p?e.jsx(T.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"}):e.jsx(M,{className:"w-5 h-5 mr-2"}),p?"Signing In...":"Sign In"]})]})};export{U as S};
